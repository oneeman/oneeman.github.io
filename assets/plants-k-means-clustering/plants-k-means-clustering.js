webpackJsonp([0],{195:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e){var t=e.data,n=e.centers,a=n.map(function(e,n){var a=c.default.zipObject(t.names,e);return d.default.createElement("div",{className:"col-lg-4 choropleth-container",key:n},d.default.createElement("div",{className:"choropleth-inner-container"},d.default.createElement(v.default,{geoJSON:t.geoJSON,values:a,mean:t.mean})))});return d.default.createElement("div",{className:"row"},a)}Object.defineProperty(t,"__esModule",{value:!0}),t.PanelWithControls=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();t.ClustersPanel=u;var s=n(42),c=a(s),f=n(11),d=a(f),m=n(3),p=a(m),h=n(198),v=a(h),b=n(199);u.propTypes={data:p.default.object.isRequired,centers:p.default.arrayOf(p.default.arrayOf(p.default.number)).isRequired},(t.PanelWithControls=function(e){function t(e){r(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.data=e.data,n.n=e.data.data[0].length,n.state=n.getInitialState(n.props.k),n.interval=setInterval(function(){n.state.running&&n.step()},100),n}return l(t,e),o(t,[{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"getInitialState",value:function(e){return void 0===e?{k:void 0,kCandidate:c.default.get(this,"state.k",6),running:!1}:{k:e,i:0,centers:(0,b.initializeCenters)(this.n,e),labels:void 0,running:!1,converged:!1}}},{key:"step",value:function(){var e=(0,b.step)(this.data.data,this.state.centers,this.state.labels),t=c.default.clone(this.state);t.i+=1,t.centers=e.centers,t.labels=e.labels,c.default.isEqual(this.state.labels,e.labels)&&(t.converged=!0,t.running=!1),this.setState(t)}},{key:"startStop",value:function(){var e=c.default.clone(this.state);e.running=!this.state.running,this.setState(e)}},{key:"reset",value:function(){this.setState(this.getInitialState(this.state.k))}},{key:"changeK",value:function(){this.setState(this.getInitialState())}},{key:"setKCandidate",value:function(e){this.setState({k:void 0,running:!1,kCandidate:e})}},{key:"selectK",value:function(){this.setState(this.getInitialState(this.state.kCandidate))}},{key:"renderKSelector",value:function(){var e=this;return d.default.createElement("div",{className:"clusters-panel"},d.default.createElement("div",{className:"k-selection"},d.default.createElement("div",null,"How many clusters should we use?"),d.default.createElement("div",null,d.default.createElement("input",{type:"range",name:"numClusters",min:"2",max:"15",step:"1",value:this.state.kCandidate,onChange:function(t){e.setKCandidate(t.target.value)}}),d.default.createElement("span",{className:"k-candidate-number"},this.state.kCandidate),d.default.createElement("button",{className:"primary",onClick:function(){e.selectK()}},"Select"))))}},{key:"renderPanels",value:function(){var e=this;return d.default.createElement("div",{className:"clusters-panel"},d.default.createElement("div",{className:"controls"},d.default.createElement("button",{className:"primary",disabled:this.state.converged,onClick:function(){e.startStop()}},this.state.running?"Stop":"Run"),d.default.createElement("button",{className:"primary",disabled:this.state.running||this.state.converged,onClick:function(){e.step()}},"Run a single iteration"),d.default.createElement("button",{className:"warn",onClick:function(){e.reset()}},"Reset"),d.default.createElement("button",{className:"default",onClick:function(){e.changeK()}},"Change number of clusters"),d.default.createElement("div",{className:"k-means-status"},d.default.createElement("div",null,"Iterations completed: ",this.state.i," ",this.state.converged?"(reached convergence)":""))),d.default.createElement(u,{data:this.data,centers:this.state.centers}))}},{key:"render",value:function(){return void 0===this.state.k?this.renderKSelector():this.renderPanels()}}]),t}(d.default.Component)).propTypes={data:p.default.object.isRequired,k:p.default.number}},196:function(e,t,n){"use strict";function a(e){return e.crs={type:"name",properties:{name:"miller"}},e}function r(){return Promise.all([l(),u(),i()]).then(function(e){var t=f(e,2),n=t[0],r=t[1];return p.original=s(n,p.abbrOriginal),p.fixed=s(n,p.abbrFixed),p.mapGeoJSON=a(r),p.mean=m.default.mean(p.original.map(function(e){return m.default.mean(e)})),p})}function i(){return fetch("/assets/plants-k-means-clustering/stateabbr.txt").then(function(e){return e.text()}).then(function(e){var t=e.split("\n").filter(function(e){return e.length>0}),n=t.map(function(e){var t=e.indexOf(" ");return[e.slice(0,t),e.slice(t+1)]});return m.default.fromPairs(n)}).then(function(e){p.abbrOriginal=e,p.abbrFixed=m.default.clone(e),p.abbrFixed.ab=e.al,p.abbrFixed.al=e.ab,p.namesOriginal=c(p.abbrOriginal),p.namesFixed=c(p.abbrFixed)})}function l(){return fetch("/assets/plants-k-means-clustering/plants.data").then(function(e){return e.text()}).then(o)}function u(){return fetch("/assets/plants-k-means-clustering/states.geojson").then(function(e){return e.json()})}function o(e){return m.default.filter(e.split("\n")).map(function(e){return e.split(",").slice(1)})}function s(e,t){var n=m.default.keys(t);return n.sort(),e.map(function(e){return n.map(function(t){return e.includes(t)?1:0})})}function c(e){var t=m.default.toPairs(e);return t.sort(),t.map(function(e){return e[1]})}Object.defineProperty(t,"__esModule",{value:!0});var f=function(){function e(e,t){var n=[],a=!0,r=!1,i=void 0;try{for(var l,u=e[Symbol.iterator]();!(a=(l=u.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{!a&&u.return&&u.return()}finally{if(r)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.default=r,n(481);var d=n(42),m=function(e){return e&&e.__esModule?e:{default:e}}(d),p={}},198:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e){var t=_.default.scale(["red","white","green"]).domain([0,e.mean,1]),n={x:-.001002,y:49e-5},a={style:{height:172,width:338}},r={zoom:19,center:[n.y,n.x],dragging:!1,touchZoom:!1,scrollWheelZoom:!1,doubleClickZoom:!1,boxZoom:!1,tap:!1,keyboard:!1,zoomControl:!1,attributionControl:!1,zoomAnimation:!1},i=function(n){var a=n.properties.woe_name;return{color:"grey",weight:1.5,opacity:1,fillColor:o(e.values,a,t)}};return p.default.createElement("div",c({className:"plants-choropleth-map"},a),p.default.createElement(y.Map,c({id:e.id},r),p.default.createElement(E,{style:i,data:e.geoJSON})))}function o(e,t,n){if(null==t)return null;var a=void 0;return a="Newfoundland and Labrador"===t?(e.Newfoundland+e.Labrador)/2:e[t],n(a)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e};t.default=u;var f=n(42),d=a(f),m=n(11),p=a(m),h=n(3),v=a(h),b=n(5),y=n(465),g=n(160),O=a(g);n(372);var k=n(201),_=a(k);O.default.defs("miller","+proj=mill +lat_0=0 +lon_0=0 +x_0=0 +y_0=0 +R_A +ellps=WGS84 +datum=WGS84 +units=m no_defs"),u.propTypes={geoJSON:v.default.object.isRequired,mean:v.default.number.isRequired,values:v.default.objectOf(v.default.number)},u.defaultProps={values:{},mean:.5};var E=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,e),s(t,[{key:"createLeafletElement",value:function(e){var t=d.default.clone(e),n=e.data;return delete t.data,b.Proj.geoJson(n,this.getOptions(t))}}]),t}(y.GeoJSON)},199:function(e,t,n){"use strict";function a(e,t){for(var n=0,a=0;a<e.length;a++){var r=t[a]-e[a];n+=r*r}return Math.sqrt(n)}function r(e,t){var n=function(){return s.default.times(e,Math.random)};return s.default.times(t,n)}function i(e,t){for(var n=[],r=0;r<e.length;r++){for(var i=e[r],l=0,u=a(i,t[0]),o=1;o<t.length;o++){var s=a(i,t[o]);s<u&&(l=o,u=s)}n.push(l)}return n}function l(e,t,n){for(var a=e.length,r=e[0].length,i=s.default.times(t,function(){return s.default.times(r,function(){return[]})}),l=0;l<a;l++)for(var u=e[l],o=n[l],c=0;c<r;c++)i[o][c].push(u[c]);return i.map(function(e){return e.map(s.default.mean)})}function u(e,t,n){n=n||i(e,t);var a=l(e,t.length,n);return{centers:a,labels:i(e,a)}}Object.defineProperty(t,"__esModule",{value:!0}),t.initializeCenters=r,t.classify=i,t.updateCenters=l,t.step=u;var o=n(42),s=function(e){return e&&e.__esModule?e:{default:e}}(o)},200:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var r=n(11),i=a(r),l=n(43),u=a(l),o=n(196),s=a(o),c=n(195),f=void 0;(0,s.default)().then(function(e){f=e;var t={geoJSON:f.mapGeoJSON,data:f.original,abbr:f.abbrOriginal,names:f.namesOriginal,mean:f.mean};u.default.render(i.default.createElement(c.PanelWithControls,{data:t,k:6}),document.getElementById("plants-original-cluster-panel"));var n={geoJSON:f.mapGeoJSON,data:f.fixed,abbr:f.abbrFixed,names:f.namesFixed,mean:f.mean};u.default.render(i.default.createElement(c.PanelWithControls,{data:n,k:6}),document.getElementById("plants-fixed-cluster-panel"))})}},[200]);
//# sourceMappingURL=plants-k-means-clustering.js.map